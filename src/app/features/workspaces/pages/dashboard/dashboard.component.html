<section class="dashboard">
  <header class="hero">
    <div class="hero-copy">
      <p class="eyebrow">Workspace Overview</p>
      <h1>Dashboard</h1>
      <p class="subtext">Clear visibility of progress, work health, and upcoming priorities.</p>
      <div class="hero-actions">
        <a class="btn primary" [routerLink]="['/projects/new']">
          <i class="pi pi-plus"></i>
          New Project
        </a>
        <a class="btn ghost" [routerLink]="['/tasks']">
          View Tasks
        </a>
      </div>
    </div>
    <div class="hero-panel">
      <div class="panel-row">
        <div class="kpi">
          <span class="kpi-label">Total</span>
          <span class="kpi-value">{{ taskStats.total }}</span>
          <span class="kpi-meta">Registered tasks</span>
        </div>
        <div class="kpi">
          <span class="kpi-label">Assigned</span>
          <span class="kpi-value">{{ taskStats.assigned }}</span>
          <span class="kpi-meta">{{ getPercentage(taskStats.assigned, taskStats.total) }} of total</span>
        </div>
      </div>
      <div class="panel-row">
        <div class="kpi">
          <span class="kpi-label">Completed</span>
          <span class="kpi-value">{{ taskStats.completed }}</span>
          <span class="kpi-meta">{{ getPercentage(taskStats.completed, taskStats.total) }} of total</span>
        </div>
        <div class="kpi danger" *ngIf="taskStats.overdue > 0; else noOverdue">
          <span class="kpi-label">Overdue</span>
          <span class="kpi-value">{{ taskStats.overdue }}</span>
          <span class="kpi-meta">Require attention</span>
        </div>
        <ng-template #noOverdue>
          <div class="kpi success">
            <span class="kpi-label">Overdue</span>
            <span class="kpi-value">0</span>
            <span class="kpi-meta">No blockers</span>
          </div>
        </ng-template>
      </div>
    </div>
  </header>

  <section class="stats-grid">
    <article class="stat-card">
      <div class="stat-header">
        <h3>Total Tasks</h3>
        <span class="chip">Global</span>
      </div>
      <div class="ring" style="--accent: #0ea5a4;" [style.--percent]="100">
        <div class="ring-inner">
          <span class="ring-data">{{ taskStats.total }}</span>
          <span class="ring-percent">100%</span>
        </div>
      </div>
      <p class="stat-note">Complete view of team workload.</p>
    </article>

    <article class="stat-card">
      <div class="stat-header">
        <h3>My Assignments</h3>
        <span class="chip accent">In Focus</span>
      </div>
      <div class="ring" style="--accent: #2563eb;" [style.--percent]="getPercentageValue(taskStats.assigned, taskStats.total)">
        <div class="ring-inner">
          <span class="ring-data">{{ taskStats.assigned }}</span>
          <span class="ring-percent">{{ getPercentage(taskStats.assigned, taskStats.total) }}</span>
        </div>
      </div>
      <p class="stat-note">Direct workload assigned to you.</p>
    </article>

    <article class="stat-card">
      <div class="stat-header">
        <h3>Completed</h3>
        <span class="chip success">Health</span>
      </div>
      <div class="ring" style="--accent: #22c55e;" [style.--percent]="getPercentageValue(taskStats.completed, taskStats.total)">
        <div class="ring-inner">
          <span class="ring-data">{{ taskStats.completed }}</span>
          <span class="ring-percent">{{ getPercentage(taskStats.completed, taskStats.total) }}</span>
        </div>
      </div>
      <p class="stat-note">Team completion velocity.</p>
    </article>

    <article class="stat-card danger" *ngIf="taskStats.overdue > 0; else overdueEmpty">
      <div class="stat-header">
        <h3>Overdue</h3>
        <span class="chip danger">Risk</span>
      </div>
      <div class="ring" style="--accent: #ef4444;" [style.--percent]="getPercentageValue(taskStats.overdue, taskStats.total)">
        <div class="ring-inner">
          <span class="ring-data">{{ taskStats.overdue }}</span>
          <span class="ring-percent">{{ getPercentage(taskStats.overdue, taskStats.total) }}</span>
        </div>
      </div>
      <p class="stat-note">Prioritize resolving blockers.</p>
    </article>
    <ng-template #overdueEmpty>
      <article class="stat-card muted">
        <div class="stat-header">
          <h3>Overdue</h3>
          <span class="chip neutral">Stable</span>
        </div>
        <div class="ring" style="--accent: #94a3b8;" [style.--percent]="0">
          <div class="ring-inner">
            <span class="ring-data">0</span>
            <span class="ring-percent">0%</span>
          </div>
        </div>
        <p class="stat-note">Everything on time, great work.</p>
      </article>
    </ng-template>
  </section>

  <section class="grid-two">
    <article class="panel">
      <div class="panel-header">
        <div>
          <h2>Active Projects</h2>
          <p>Quick tracking of workspace projects.</p>
        </div>
        <a class="link" [routerLink]="['/projects']">View all</a>
      </div>

      <div class="project-list" *ngIf="projects.length; else emptyProjects">
        <div class="project-row" *ngFor="let project of projects | slice:0:5">
          <div class="project-main">
            <div class="project-code">{{ project.code }}</div>
            <div>
              <div class="project-name">{{ project.name }}</div>
              <div class="project-meta">{{ project.type }} - {{ project.visibility }}</div>
            </div>
          </div>
          <div class="project-status" [class.is-active]="project.status === 'ONGOING'">
            {{ project.status || 'N/A' }}
          </div>
        </div>
      </div>
      <ng-template #emptyProjects>
        <div class="empty-state">
          <p>No projects in this workspace yet.</p>
          <a class="btn ghost" [routerLink]="['/projects/new']">Create project</a>
        </div>
      </ng-template>
    </article>

    <article class="panel">
      <div class="panel-header">
        <div>
          <h2>Quick Insights</h2>
          <p>Key signals to decide in minutes.</p>
        </div>
      </div>
      <div class="insights">
        <div class="insight">
          <span class="insight-label">Efficiency</span>
          <span class="insight-value">{{ getPercentage(taskStats.completed, taskStats.total) }}</span>
          <span class="insight-meta">Tasks completed</span>
        </div>
        <div class="insight">
          <span class="insight-label">Workload</span>
          <span class="insight-value">{{ taskStats.assigned }}</span>
          <span class="insight-meta">Assigned to you</span>
        </div>
        <div class="insight">
          <span class="insight-label">Risk</span>
          <span class="insight-value">{{ taskStats.overdue }}</span>
          <span class="insight-meta">Overdue</span>
        </div>
      </div>
    </article>
  </section>
</section>
